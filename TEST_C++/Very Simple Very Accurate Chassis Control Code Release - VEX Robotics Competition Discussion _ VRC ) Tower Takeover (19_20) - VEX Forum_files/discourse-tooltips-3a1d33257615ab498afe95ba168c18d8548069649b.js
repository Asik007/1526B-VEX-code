define("discourse/plugins/discourse-tooltips/initializers/attach-hover-event",["exports","discourse/lib/plugin-api","discourse/plugins/discourse-tooltips/mixins/topic-hover-extension"],(function(t,e,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={name:"attach-hover-event",initialize:function(){(0,e.withPluginApi)("0.8.9",(function(t){t.modifyClass("component:topic-list",(0,i.hoverExtension)(".raw-topic-link")),t.modifyClass("component:categories-topic-list",(0,i.hoverExtension)(".main-link a.title"))}))}};t.default=o})),define("discourse/plugins/discourse-tooltips/mixins/topic-hover-extension",["exports","discourse/lib/ajax","discourse-common/lib/object"],(function(t,e,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hoverExtension=function(t){return{didInsertElement:function(){this._super.apply(this,arguments),this.capabilities.touch||(a(),$(this.element).on("mouseenter.discourse-tooltips",t,(function(t){var r=this,p=$(this),u=$(t.currentTarget);void 0===u.attr("data-topic-id")&&(u=u.parents("[data-topic-id]").last());var d=parseInt(u.attr("data-topic-id"),10);if(d){if(a(),n=!0,s[d])return c(p,s[d].excerpt);if(l)return;var f=[d];u.nextAll("[data-topic-id]:lt(".concat(4,")")).each((function(t,e){var i=parseInt(e.getAttribute("data-topic-id"),10);s[i]||f.push(i)})),(o=(0,e.ajax)("/tooltip-previews",{data:{topic_ids:f},cache:!0})).then((function(t){t&&t.excerpts&&(0,i.deepMerge)(s,t.excerpts),n&&c(p,s[d].excerpt)})).catch((function(t){var e=t.jqXHR;if(e&&429===e.status){l=!0;var i=parseInt(e.getResponseHeader&&e.getResponseHeader("Retry-After"),10)||0;(i=i||0)<15&&(i=15),r.rateLimiter=Ember.run.later(r,(function(){l=!1}),1e3*i)}}))}})),$(this.element).on("mouseleave.discourse-tooltips",t,(function(){return r()})))},willDestroyElement:function(){Ember.run.cancel(this.rateLimiter),l=!1,this._super.apply(this,arguments),this.capabilities.touch||(a(),$(this.element).find(t).off("mouseenter.discourse-tooltips, mouseleave.discourse-tooltips",t))}}};var o,s={},n=!1;function r(){$(".d-tooltip").remove(),n=!1}function a(){o&&(o.abort(),o=null),r()}function c(t,e){t.after("<div class='d-tooltip'><div class='d-tooltip-pointer'></div><div class='d-tooltip-content'>".concat(e,"</div></div></div>"));var i=$(".d-tooltip"),o=i.outerWidth(),s=t.width(),n=t.height(),r=t.position(),a=r.left,c=r.top+n,l=a+s/2-o/2;(t.hasClass("main-link")?t:t.parents(".main-link")).offset().left+l<0&&(l=a),i.css({left:"".concat(l,"px"),top:"".concat(c,"px")}),i.fadeIn(200)}var l=!1}));
//# sourceMappingURL=/assets/plugins/discourse-tooltips-3a1d33257615ab498afe95ba168c18d8548069649b07a0b8848eb1b9260ed44e.js.map