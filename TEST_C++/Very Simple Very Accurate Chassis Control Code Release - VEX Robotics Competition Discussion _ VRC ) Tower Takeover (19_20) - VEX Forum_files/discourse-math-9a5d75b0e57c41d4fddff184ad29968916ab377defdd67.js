define("discourse/plugins/discourse-math/lib/discourse-markdown/discourse-math",["exports"],(function(t){"use strict";function e(t,e,a){return t!==e&&(!!a.utils.isWhiteSpace(t)||(!!a.utils.isMdAsciiPunct(t)||!!a.utils.isPunctChar(t)))}function a(t,a,i){var s,n=t.pos,r=t.posMax;if(a||t.src.charCodeAt(n)!==i||r<n+2)return!1;if(t.src.charCodeAt(n+1)===i)return!1;if(n>0&&!e(t.src.charCodeAt(n-1),i,t.md))return!1;for(var c=n+1;c<r;c++){if(t.src.charCodeAt(c)===i&&92!==t.src.charCodeAt(c-1)){s=c;break}}if(!s)return!1;if(s+1<=r){var o=t.src.charCodeAt(s+1);if(o&&!e(o,i,t.md))return!1}var u=t.src.slice(n+1,s),h=t.push("html_raw","",0),d=t.md.utils.escapeHtml(u),l=36===i?"'math'":"'asciimath'";return h.content="<span class=".concat(l,">").concat(d,"</span>"),t.pos=s+1,!0}function i(t,e){return a(t,e,36)}function s(t,e){return a(t,e,37)}function n(t,e,a,i){if(36!==t.src.charCodeAt(e))return!1;if(e++,36!==t.src.charCodeAt(e))return!1;for(var s=++e;s<a;s++)if(!i.utils.isSpace(t.src.charCodeAt(s)))return!1;return!0}function r(t,e,a,i){if(!n(t,t.bMarks[e]+t.tShift[e],t.eMarks[e],t.md))return!1;if(i)return!0;for(var s=e,r=!1;!(++s>=a);)if(n(t,t.bMarks[s]+t.tShift[s],t.eMarks[s],t.md)){r=!0;break}var c=t.push("html_raw","",0),o=r?t.eMarks[s-1]:t.eMarks[s],u=t.src.slice(t.bMarks[e+1]+t.tShift[e+1],o),h=t.md.utils.escapeHtml(u);return c.content="<div class='math'>\n".concat(h,"\n</div>\n"),t.line=r?s+1:s,!0}Object.defineProperty(t,"__esModule",{value:!0}),t.setup=function(t){if(!t.markdownIt)return;t.registerOptions((function(t,e){t.features.math=e.discourse_math_enabled,t.features.asciimath=e.discourse_math_enable_asciimath})),t.registerPlugin((function(t){t.options.discourse.features.math&&(t.options.discourse.features.asciimath&&t.inline.ruler.after("escape","asciimath",s),t.inline.ruler.after("escape","math",i),t.block.ruler.after("code","math",r,{alt:["paragraph","reference","blockquote","list"]}))}))}})),define("discourse/plugins/discourse-math/initializers/discourse-math-katex",["exports","discourse/lib/plugin-api","discourse/lib/load-script"],(function(t,e,a){"use strict";function i(t){if(t&&t.find){var e=t.find(".math");e.length>0&&(0,a.default)("/plugins/discourse-math/katex/katex.min.js").then((function(){return(0,a.default)("/plugins/discourse-math/katex/katex.min.css",{css:!0}).then((function(){return(0,a.default)("/plugins/discourse-math/katex/mhchem.min.js")}))})).then((function(){e.each((function(t,e){return function(t){var e=$(t),a="DIV"===t.tagName;if(!e.data("applied-katex")&&(e.data("applied-katex",!0),e.hasClass("math"))){var i="div"==("DIV"===t.tagName?"div":"span")?"block-math":"inline-math",s=e.text();e.addClass("math-container ".concat(i," katex-math")).text(""),window.katex.render(s,t,{displayMode:a})}}(e)}))}))}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s={name:"apply-math-katex",initialize:function(t){var a=t.lookup("site-settings:main");a.discourse_math_enabled&&"katex"===a.discourse_math_provider&&(0,e.withPluginApi)("0.5",(function(t){!function(t){t.decorateCooked((function(t){i(t)}),{id:"katex"})}(t)}))}};t.default=s})),define("discourse/plugins/discourse-math/initializers/discourse-math-mathjax",["exports","discourse/lib/plugin-api","discourse-common/lib/get-url","discourse/lib/load-script"],(function(t,e,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=!1;function n(t){return function(t){if(!s){var e=["toMathML.js","Safe.js"];t.enable_accessibility&&e.push("[a11y]/accessibility-menu.js");var i={jax:["input/TeX","input/AsciiMath","input/MathML","output/CommonHTML"],TeX:{extensions:["AMSmath.js","AMSsymbols.js","autoload-all.js"]},extensions:e,showProcessingMessages:!1,root:(0,a.getURLWithCDN)("/plugins/discourse-math/mathjax")};t.zoom_on_hover&&(i.menuSettings={zoom:"Hover"},i.MathEvents={hover:750}),window.MathJax=i,s=!0}}(t),(0,i.default)("/plugins/discourse-math/mathjax/MathJax.2.7.5.js")}function r(t,e){var a;if(t&&t.find&&(a=e.enable_asciimath?t.find(".math, .asciimath"):t.find(".math")).length>0){var i=t.hasClass("d-editor-preview");n(e).then((function(){a.each((function(t,e){return function(t,e){var a=$(t);if(!a.data("applied-mathjax")){var i,s;if(a.data("applied-mathjax",!0),a.hasClass("math")){var n="DIV"===t.tagName?"div":"span",r="div"===n?"block-math":"inline-math",c="math/tex".concat("div"===n?"; mode=display":""),o="math-container ".concat(r," mathjax-math");i=$("<".concat(n,' class="').concat(o,'" style="display: none;">\n         <script type="').concat(c,'"><\/script>\n       </').concat(n,">")),(s=i.children()).text(a.text()),a.after(i)}else a.hasClass("asciimath")&&(i=$('<span class="'.concat("math-container inline-math ascii-math",'" style="display: none;">\n         <script type="').concat("math/asciimath",'"><\/script>\n       </span>')),(s=i.children()).text(a.text()),a.after(i));Ember.run.later(this,(function(){window.MathJax.Hub.Queue((function(){t.parentElement&&null!==t.parentElement.offsetParent&&window.MathJax.Hub.Typeset(s[0],(function(){a.hide(),i.show()}))}))}),e?200:0)}}(e,i)}))}))}}var c={name:"apply-math-mathjax",initialize:function(t){var a=t.lookup("site-settings:main"),i={zoom_on_hover:a.discourse_math_zoom_on_hover,enable_accessibility:a.discourse_math_enable_accessibility,enable_asciimath:a.discourse_math_enable_asciimath};a.discourse_math_enabled&&"mathjax"===a.discourse_math_provider&&(0,e.withPluginApi)("0.5",(function(t){!function(t,e){t.decorateCooked((function(t){r(t,e)}),{id:"mathjax"})}(t,i)}))}};t.default=c}));
//# sourceMappingURL=/assets/plugins/discourse-math-9a5d75b0e57c41d4fddff184ad29968916ab377defdd67cce58c5211227907b8.js.map